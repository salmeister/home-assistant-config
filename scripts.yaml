kitchen_closed:
  alias: Kitchen Closed
  sequence:
  - service: scene.turn_on
    entity_id:
    - scene.kitchen_closed
school_lunches:
  alias: School Lunches
  sequence:
  - data:
      entity_id: media_player.kitchen_hub
      view_path: kitchen
    action: cast.show_lovelace_view
house_shutdown:
  alias: House Shutdown
  sequence:
  - target:
      entity_id: scene.full_shutdown
    metadata: {}
    action: scene.turn_on
    data: {}
  - delay: 00:02:00
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id:
      - switch.kitchen_counters
      - switch.piano_room_counter_lights
  - delay: 00:15:00
  - action: homeassistant.update_entity
    data:
      entity_id:
      - sensor.next_alarm
  - data: {}
    target:
      entity_id:
      - input_boolean.external_armed_mode
      - input_boolean.bedtime
    action: input_boolean.turn_on
  - data: {}
    target:
      entity_id: light.foyer
    action: light.turn_off
  mode: single
dog_last_fed:
  alias: Dogs Last Fed
  sequence:
  - service: notify.google_assistant_sdk
    data:
      message: The dogs were last fed at {{ states('input_datetime.dogs_last_fed')
        }}
      target:
      - kitchen
turn_off_basement_lights:
  alias: Turn Off Basement Lights
  sequence:
  - service: light.turn_off
    data: {}
    target:
      entity_id:
      - light.basement_hall
      - light.basement_tv_lights
      - light.basement_main_lights
      - light.bar_lights
      - light.bar_led_lights
      - light.bar_tv_led_lights
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.basement_peninsula_lights
  - delay:
      hours: 0
      minutes: 2
      seconds: 0
      milliseconds: 0
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.basement_stairs
  mode: single
basement_lights_to_warm_modify_active_lights:
  alias: 'Basement Lights To Warm: Modify Active Lights'
  use_blueprint:
    path: salmeister/modify_active_lights.yaml
    input:
      target_lights: light.all_basement_downlights
      color_temp_kelvin: 370
      color_name: White
      color_temp: 480
  mode: single
basement_lights_to_cool_modify_active_lights:
  alias: 'Basement Lights To Cool: Modify Active Lights'
  use_blueprint:
    path: salmeister/modify_active_lights.yaml
    input:
      color_temp_kelvin: 215
      target_lights: light.all_basement_downlights
      color_temp: 165
  mode: single
basement_lights_to_red_modify_active_lights:
  alias: 'Basement Lights To Red: Modify Active Lights'
  use_blueprint:
    path: salmeister/modify_active_lights.yaml
    input:
      color_name: Red
      target_lights: light.all_basement_downlights
  mode: single
basement_lights_to_green_modify_active_lights:
  alias: 'Basement Lights To Green: Modify Active Lights'
  use_blueprint:
    path: salmeister/modify_active_lights.yaml
    input:
      color_name: Green
      target_lights: light.all_basement_downlights
  mode: single
basement_lights_to_blue_modify_active_lights:
  alias: 'Basement Lights To Blue: Modify Active Lights'
  use_blueprint:
    path: salmeister/modify_active_lights.yaml
    input:
      color_name: Blue
      target_lights: light.all_basement_downlights
  mode: single
basement_to_bright_modify_active_lights:
  alias: 'Basement Lights To Bright: Modify Active Lights'
  use_blueprint:
    path: salmeister/modify_active_lights.yaml
    input:
      color_name: NA
      brightness_pct: 100
      target_lights: light.all_basement_downlights
  mode: single
basement_to_dim_modify_active_lights:
  alias: 'Basement Lights To Dim: Modify Active Lights'
  use_blueprint:
    path: salmeister/modify_active_lights.yaml
    input:
      color_name: NA
      target_lights: light.all_basement_downlights
      brightness_pct: 25
  mode: single
basement_step_up_brightness_modify_active_lights:
  alias: 'Basement Step Up Brightness: Modify Active Lights'
  use_blueprint:
    path: salmeister/modify_active_lights.yaml
    input:
      color_name: NA
      target_lights: light.all_basement_downlights
      brightness_step: 10
  mode: single
basement_step_down_brightness_modify_active_lights:
  alias: 'Basement Step Down Brightness: Modify Active Lights'
  use_blueprint:
    path: salmeister/modify_active_lights.yaml
    input:
      color_name: NA
      target_lights: light.all_basement_downlights
      brightness_step: -10
  mode: single
basement_color_loop:
  alias: 'Basement: Color Loop'
  use_blueprint:
    path: mdolnik/color_loop.yaml
    input:
      light: light.all_basement_downlights
      transition:
        hours: 0
        minutes: 0
        seconds: 30
      color_1:
      - 255
      - 0
      - 0
      max_color_distance: 60
      color_2:
      - 1
      - 9
      - 249
      color_3:
      - 0
      - 255
      - 51
      color_4:
      - 236
      - 240
      - 5
      color_5:
      - 231
      - 2
      - 247
      color_6:
      - 8
      - 219
      - 247
      color_7:
      - 253
      - 138
      - 8
      color_8:
      - 128
      - 126
      - 129
      color_9:
      - 4
      - 246
      - 121
      color_10:
      - 3
      - 1
      - 111
      color_11:
      - 85
      - 2
      - 2
      color_12:
      - 11
      - 66
      - 0
  mode: single
basement_zwave_to_physical:
  mode: single
  sequence:
  - service: light.turn_on
    data: {}
    target:
      entity_id:
      - light.all_basement_downlights
      - light.basement_bedroom_closet
      - light.basement_stairs_closet
  - service: zwave_js.set_config_parameter
    target:
      entity_id:
      - switch.basement_bar_area_lights
      - switch.basement_hall_light
      - switch.basement_main_lights
      - switch.basement_tv_side_lights
    data:
      parameter: 12
      value: 1
  - service: zwave_js.set_config_parameter
    target:
      entity_id:
      - switch.basement_tv_room_lights
    data:
      parameter: 19
      value: 1
  - service: automation.turn_off
    data: {}
    target:
      entity_id:
      - automation.bar_lights_zooz_zen76_control_smart_light_configuration
      - automation.bar_peninsula_zooz_zen76_control_smart_light_configuration
      - automation.basement_main_zooz_zen76_control_smart_light_configuration
      - automation.basement_tv_room_zooz_zen76_control_smart_light_configuration
      - automation.basement_hall_zooz_zen76_control_smart_light_configuration
      - automation.basement_stairs_zen32_z_wave_js
      - automation.basement_tv_room_lights
      - automation.basement_bedroom_closet_contact_sensor_toggle_lights
      - automation.basement_stairs_contact_sensor_toggle_lights
  - service: switch.turn_off
    data: {}
    target:
      entity_id:
      - switch.basement_bar_area_lights
      - switch.basement_hall_light
      - switch.basement_main_lights
      - switch.basement_tv_side_lights
      - switch.basement_tv_room_lights
basement_zwave_to_virtual:
  mode: single
  sequence:
  - service: switch.turn_on
    data: {}
    target:
      entity_id:
      - switch.basement_bar_area_lights
      - switch.basement_hall_light
      - switch.basement_main_lights
      - switch.basement_tv_side_lights
      - switch.basement_tv_room_lights
  - service: automation.turn_on
    data: {}
    target:
      entity_id:
      - automation.bar_lights_zooz_zen76_control_smart_light_configuration
      - automation.bar_peninsula_zooz_zen76_control_smart_light_configuration
      - automation.basement_main_zooz_zen76_control_smart_light_configuration
      - automation.basement_tv_room_zooz_zen76_control_smart_light_configuration
      - automation.basement_hall_zooz_zen76_control_smart_light_configuration
      - automation.basement_stairs_zen32_z_wave_js
      - automation.basement_tv_room_lights
      - automation.basement_bedroom_closet_contact_sensor_toggle_lights
      - automation.basement_stairs_contact_sensor_toggle_lights
  - service: zwave_js.set_config_parameter
    target:
      entity_id:
      - switch.basement_bar_area_lights
      - switch.basement_hall_light
      - switch.basement_main_lights
      - switch.basement_tv_side_lights
    data:
      parameter: 12
      value: 0
  - service: zwave_js.set_config_parameter
    target:
      entity_id:
      - switch.basement_tv_room_lights
    data:
      parameter: 19
      value: 0
  - service: light.turn_off
    data: {}
    target:
      entity_id:
      - light.all_basement_downlights
      - light.basement_bedroom_closet
      - light.basement_stairs_closet
cam_color_loop:
  alias: Cam Color Loop
  sequence:
  - service: light.turn_on
    data:
      effect: colorloop
    target:
      entity_id: light.cams_led_lights
  mode: single
cam_color_strobe:
  alias: Cam Color Strobe
  sequence:
  - service: light.turn_on
    data:
      effect: colorstrobe
    target:
      entity_id: light.cams_led_lights
  mode: single
cam_color_jump:
  alias: Cam Color Jump
  sequence:
  - service: light.turn_on
    data:
      effect: colorjump
    target:
      entity_id: light.cams_led_lights
  mode: single
notify_parents_with_picture:
  alias: Notify Parents with Picture
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_boolean.notify_fpm_andy
        state: 'on'
      sequence:
      - service: notify.mobile_app_salmob1
        data:
          message: '{{ message }}'
          data:
            ttl: 0
            priority: high
            sticky: 'true'
            image: '{{ cameraURL }}'
    - conditions:
      - condition: state
        entity_id: input_boolean.notify_fpm_katie
        state: 'on'
      sequence:
      - service: notify.mobile_app_salmob2
        data:
          message: '{{ message }}'
          data:
            ttl: 0
            priority: high
            image: '{{ cameraURL }}'
  mode: single
close_garage_from_google:
  alias: Close Garage from Google Assistant
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: cover.garage_doors
        state: 'open'
      sequence:
      - data: {}
        target:
          entity_id: cover.garage_doors
        action: cover.close_cover
      - data:
          message: "Closing the garage door now."
          target:
          - kitchen
        action: notify.google_assistant_sdk
      - data: {}
        target:
          entity_id: input_boolean.garage_hub_notification_active
        action: input_boolean.turn_off
    default:
    - data:
        message: "The garage door is already closed."
        target:
        - kitchen
      action: notify.google_assistant_sdk
  mode: single

git_sync_changes:
  alias: Git Sync Changes
  sequence:
  # Step 1: Check for updates (sensor handles this automatically)
  # Step 2: Begin sync process
  - service: input_boolean.turn_off
    target:
      entity_id: input_boolean.github_operation_error
  # Step 3: Create sync in progress notification
  - service: persistent_notification.create
    data:
      title: "ðŸ”„ Git Sync"
      message: "Syncing configuration changes with GitHub repository..."
      notification_id: "git_sync_status"
  - service: shell_command.git_pull_config
  - delay: '00:00:10'
  # Step 4: Notify git pull result
  - service: persistent_notification.create
    data:
      title: "ðŸ“¥ Git Pull Complete"
      message: "Git pull completed. Validating configuration..."
      notification_id: "git_sync_status"
  # Step 5: Update github_config_updates_available sensor state
  - service: homeassistant.update_entity
    target:
      entity_id: sensor.github_config_updates_available
  - delay: '00:00:02'
  # Step 6: Check config - stop if error, proceed if success
  - service: homeassistant.check_config
  - delay: '00:00:05'
  - service: persistent_notification.create
    data:
      title: "âœ… Configuration Valid"
      message: "Configuration validation passed. Updating entity registry..."
      notification_id: "git_sync_status"
  # Step 7: Update entity registry
  - service: homeassistant.update_entity
    target:
      entity_id: sensor.config_snapshots_changes_available
  - delay: '00:00:05'
  # Step 8: Conditional stage, commit, push if changes detected
  - choose:
    - conditions:
      - condition: template
        value_template: "{{ states('sensor.config_snapshots_changes_available') | int == 2 }}"
      sequence:
      - service: persistent_notification.create
        data:
          title: "ðŸ“¤ Pushing Changes"
          message: "Entity registry changes detected. Staging, committing and pushing to GitHub..."
          notification_id: "git_sync_status"
      - service: shell_command.git_stage_entity_registry
      - delay: '00:00:02'
      - service: shell_command.git_commit_entity_registry
      - delay: '00:00:02'
      - service: shell_command.git_push_entity_registry
      - delay: '00:00:05'
      # Step 9: Final notification - with changes pushed
      - service: persistent_notification.create
        data:
          title: "âœ… Git Sync Complete"
          message: "Configuration successfully synced with GitHub. Entity registry changes committed and pushed back to repository. Next step, reload YAML."
          notification_id: "git_sync_status"
      - service: homeassistant.update_entity
        target:
          entity_id: sensor.config_snapshots_changes_available
    default:
    # Step 9: Final notification - no entity registry changes
    - service: persistent_notification.create
      data:
        title: "âœ… Git Sync Complete"
        message: "Configuration successfully synced with GitHub. No entity registry changes detected. Next step, reload YAML."
        notification_id: "git_sync_status"
  mode: single
  